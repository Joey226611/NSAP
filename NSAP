local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- UI Creation
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PauliesAdminUI"
screenGui.ResetOnSpawn = false

-- INTRO UI
local introFrame = Instance.new("Frame")
introFrame.Name = "IntroFrame"
introFrame.Size = UDim2.new(0.6, 0, 0.3, 0)
introFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
introFrame.AnchorPoint = Vector2.new(0.5, 0.5)
introFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
introFrame.BorderSizePixel = 0
introFrame.Parent = screenGui
introFrame.Visible = true

local introCorner = Instance.new("UICorner")
introCorner.CornerRadius = UDim.new(0, 24)
introCorner.Parent = introFrame

local introLabel = Instance.new("TextLabel")
introLabel.Name = "IntroLabel"
introLabel.Text = "Made by JoeyStudios"
introLabel.Font = Enum.Font.GothamBlack
introLabel.TextSize = 48
introLabel.TextColor3 = Color3.fromRGB(80, 180, 255)
introLabel.BackgroundTransparency = 1
introLabel.Size = UDim2.new(1, 0, 1, 0)
introLabel.Position = UDim2.new(0, 0, 0, 0)
introLabel.Parent = introFrame

introFrame.BackgroundTransparency = 1
introLabel.TextTransparency = 1
introFrame.Size = UDim2.new(0.2, 0, 0.1, 0)

-- Animate intro: fade in, scale up, hold, fade out
local function playIntro()
	introFrame.Visible = true
	-- Fade in and scale up
	local fadeIn = TweenService:Create(introFrame, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundTransparency = 0, Size = UDim2.new(0.6, 0, 0.3, 0)})
	local textIn = TweenService:Create(introLabel, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0})
	fadeIn:Play()
	textIn:Play()
	fadeIn.Completed:Wait()
	-- Hold for 3 seconds
	task.wait(3)
	-- Fade out and scale down
	local fadeOut = TweenService:Create(introFrame, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {BackgroundTransparency = 1, Size = UDim2.new(0.2, 0, 0.1, 0)})
	local textOut = TweenService:Create(introLabel, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {TextTransparency = 1})
	fadeOut:Play()
	textOut:Play()
	fadeOut.Completed:Wait()
	introFrame.Visible = false
end

-- MainFrame (admin panel) creation (hidden at start)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 500, 0, 350)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -175)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Visible = false -- Hide until intro is done

mainFrame.Active = true

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 12)
uiCorner.Parent = mainFrame

-- Drag logic
local dragging = false
local dragInput, dragStart, startPos

mainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

mainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

-- TopBar
local topBar = Instance.new("Frame")
topBar.Name = "TopBar"
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame

local topBarCorner = Instance.new("UICorner")
topBarCorner.CornerRadius = UDim.new(0, 12)
topBarCorner.Parent = topBar

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Text = "Night shift at Paulies Admin UI"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(255,255,255)
title.BackgroundTransparency = 1
title.Size = UDim2.new(0.6, 0, 1, 0)
title.Position = UDim2.new(0, 12, 0, 0)
title.Parent = topBar

-- Tab Buttons
local playerSettingsTabBtn = Instance.new("TextButton")
playerSettingsTabBtn.Name = "PlayerSettingsTabBtn"
playerSettingsTabBtn.Text = "Player settings"
playerSettingsTabBtn.Font = Enum.Font.GothamBold
playerSettingsTabBtn.TextSize = 16
playerSettingsTabBtn.TextColor3 = Color3.fromRGB(255,255,255)
playerSettingsTabBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
playerSettingsTabBtn.Size = UDim2.new(0, 120, 0, 32)
playerSettingsTabBtn.Position = UDim2.new(0.65, 0, 0, 4)
playerSettingsTabBtn.Parent = topBar

local gameSettingsTabBtn = Instance.new("TextButton")
gameSettingsTabBtn.Name = "GameSettingsTabBtn"
gameSettingsTabBtn.Text = "Game Settings"
gameSettingsTabBtn.Font = Enum.Font.GothamBold
gameSettingsTabBtn.TextSize = 16
gameSettingsTabBtn.TextColor3 = Color3.fromRGB(255,255,255)
gameSettingsTabBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
gameSettingsTabBtn.Size = UDim2.new(0, 120, 0, 32)
gameSettingsTabBtn.Position = UDim2.new(0.8, 0, 0, 4)
gameSettingsTabBtn.Parent = topBar

local plusBtn = Instance.new("TextButton")
plusBtn.Name = "PlusBtn"
plusBtn.Text = "+"
plusBtn.Font = Enum.Font.GothamBold
plusBtn.TextSize = 20
plusBtn.TextColor3 = Color3.fromRGB(255,255,255)
plusBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
plusBtn.Size = UDim2.new(0, 32, 0, 32)
plusBtn.Position = UDim2.new(1, -72, 0, 4)
plusBtn.Parent = topBar

local minusBtn = Instance.new("TextButton")
minusBtn.Name = "MinusBtn"
minusBtn.Text = "-"
minusBtn.Font = Enum.Font.GothamBold
minusBtn.TextSize = 20
minusBtn.TextColor3 = Color3.fromRGB(255,255,255)
minusBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
minusBtn.Size = UDim2.new(0, 32, 0, 32)
minusBtn.Position = UDim2.new(1, -36, 0, 4)
minusBtn.Parent = topBar

-- Tab Frames
local playerSettingsTab = Instance.new("Frame")
playerSettingsTab.Name = "PlayerSettingsTab"
playerSettingsTab.Size = UDim2.new(1, -24, 1, -52)
playerSettingsTab.Position = UDim2.new(0, 12, 0, 48)
playerSettingsTab.BackgroundTransparency = 1
playerSettingsTab.Visible = true
playerSettingsTab.Parent = mainFrame

local gameSettingsTab = Instance.new("Frame")
gameSettingsTab.Name = "GameSettingsTab"
gameSettingsTab.Size = UDim2.new(1, -24, 1, -52)
gameSettingsTab.Position = UDim2.new(0, 12, 0, 48)
gameSettingsTab.BackgroundTransparency = 1
gameSettingsTab.Visible = false
gameSettingsTab.Parent = mainFrame

-- Custom Slider Function (returns a table, not a Frame)
local function createSlider(parent, labelText, minValue, maxValue, defaultValue, posY)
	-- ... (slider code unchanged)
	local sliderObj = {}

	local label = Instance.new("TextLabel")
	label.Text = labelText
	label.Font = Enum.Font.Gotham
	label.TextSize = 16
	label.TextColor3 = Color3.fromRGB(255,255,255)
	label.BackgroundTransparency = 1
	label.Size = UDim2.new(0, 120, 0, 24)
	label.Position = UDim2.new(0, 0, 0, posY)
	label.Parent = parent

	local sliderFrame = Instance.new("Frame")
	sliderFrame.Name = labelText.."SliderFrame"
	sliderFrame.Size = UDim2.new(0, 200, 0, 24)
	sliderFrame.Position = UDim2.new(0, 130, 0, posY)
	sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
	sliderFrame.BorderSizePixel = 0
	sliderFrame.Parent = parent

	local sliderBar = Instance.new("Frame")
	sliderBar.Name = "SliderBar"
	sliderBar.Size = UDim2.new(1, -24, 0, 8)
	sliderBar.Position = UDim2.new(0, 12, 0.5, -4)
	sliderBar.BackgroundColor3 = Color3.fromRGB(100, 100, 140)
	sliderBar.BorderSizePixel = 0
	sliderBar.Parent = sliderFrame

	local sliderBtn = Instance.new("ImageButton")
	sliderBtn.Name = "SliderBtn"
	sliderBtn.Size = UDim2.new(0, 16, 0, 16)
	sliderBtn.Position = UDim2.new((defaultValue-minValue)/(maxValue-minValue), -8, 0.5, -8)
	sliderBtn.BackgroundColor3 = Color3.fromRGB(180,180,255)
	sliderBtn.Image = ""
	sliderBtn.Parent = sliderFrame

	local valueLabel = Instance.new("TextLabel")
	valueLabel.Name = "ValueLabel"
	valueLabel.Text = tostring(defaultValue)
	valueLabel.Font = Enum.Font.GothamBold
	valueLabel.TextSize = 14
	valueLabel.TextColor3 = Color3.fromRGB(255,255,255)
	valueLabel.BackgroundTransparency = 1
	valueLabel.Size = UDim2.new(0, 40, 0, 24)
	valueLabel.Position = UDim2.new(0, 340, 0, posY)
	valueLabel.Parent = parent

	local sliderValue = defaultValue
	local draggingSlider = false

	sliderBtn.MouseButton1Down:Connect(function()
		draggingSlider = true
	end)

	UserInputService.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			draggingSlider = false
		end
	end)

	sliderFrame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			draggingSlider = true
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if draggingSlider and input.UserInputType == Enum.UserInputType.MouseMovement then
			local absPos = sliderBar.AbsolutePosition.X
			local absSize = sliderBar.AbsoluteSize.X
			local mouseX = UserInputService:GetMouseLocation().X
			local percent = math.clamp((mouseX - absPos) / absSize, 0, 1)
			sliderValue = math.floor(minValue + (maxValue-minValue)*percent)
			sliderBtn.Position = UDim2.new(percent, -8, 0.5, -8)
			valueLabel.Text = tostring(sliderValue)
			if sliderObj.OnValueChanged then
				sliderObj.OnValueChanged(sliderValue)
			end
		end
	end)

	function sliderObj.SetValue(val)
		sliderValue = math.clamp(val, minValue, maxValue)
		local percent = (sliderValue-minValue)/(maxValue-minValue)
		sliderBtn.Position = UDim2.new(percent, -8, 0.5, -8)
		valueLabel.Text = tostring(sliderValue)
		if sliderObj.OnValueChanged then
			sliderObj.OnValueChanged(sliderValue)
		end
	end

	function sliderObj.GetValue()
		return sliderValue
	end

	sliderObj.Frame = sliderFrame
	sliderObj.ValueLabel = valueLabel
	sliderObj.OnValueChanged = nil

	return sliderObj
end

-- Player Settings UI
local walkSpeedSlider = createSlider(playerSettingsTab, "Walk Speed", 8, 100, 16, 0)
local jumpPowerSlider = createSlider(playerSettingsTab, "Jump Power", 50, 200, 50, 40)

local noclipLabel = Instance.new("TextLabel")
noclipLabel.Text = "Noclip"
noclipLabel.Font = Enum.Font.Gotham
noclipLabel.TextSize = 16
noclipLabel.TextColor3 = Color3.fromRGB(255,255,255)
noclipLabel.BackgroundTransparency = 1
noclipLabel.Size = UDim2.new(0, 120, 0, 24)
noclipLabel.Position = UDim2.new(0, 0, 0, 80)
noclipLabel.Parent = playerSettingsTab

local noclipToggle = Instance.new("TextButton")
noclipToggle.Name = "NoclipToggle"
noclipToggle.Text = "OFF"
noclipToggle.Font = Enum.Font.GothamBold
noclipToggle.TextSize = 16
noclipToggle.TextColor3 = Color3.fromRGB(255,255,255)
noclipToggle.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
noclipToggle.Size = UDim2.new(0, 60, 0, 24)
noclipToggle.Position = UDim2.new(0, 130, 0, 80)
noclipToggle.Parent = playerSettingsTab

local flyLabel = Instance.new("TextLabel")
flyLabel.Text = "Fly"
flyLabel.Font = Enum.Font.Gotham
flyLabel.TextSize = 16
flyLabel.TextColor3 = Color3.fromRGB(255,255,255)
flyLabel.BackgroundTransparency = 1
flyLabel.Size = UDim2.new(0, 120, 0, 24)
flyLabel.Position = UDim2.new(0, 0, 0, 120)
flyLabel.Parent = playerSettingsTab

local flyToggle = Instance.new("TextButton")
flyToggle.Name = "FlyToggle"
flyToggle.Text = "OFF"
flyToggle.Font = Enum.Font.GothamBold
flyToggle.TextSize = 16
flyToggle.TextColor3 = Color3.fromRGB(255,255,255)
flyToggle.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
flyToggle.Size = UDim2.new(0, 60, 0, 24)
flyToggle.Position = UDim2.new(0, 130, 0, 120)
flyToggle.Parent = playerSettingsTab

-- NEW: First/Third Person Toggle
local cameraModeLabel = Instance.new("TextLabel")
cameraModeLabel.Text = "Camera Mode"
cameraModeLabel.Font = Enum.Font.Gotham
cameraModeLabel.TextSize = 16
cameraModeLabel.TextColor3 = Color3.fromRGB(255,255,255)
cameraModeLabel.BackgroundTransparency = 1
cameraModeLabel.Size = UDim2.new(0, 120, 0, 24)
cameraModeLabel.Position = UDim2.new(0, 0, 0, 160)
cameraModeLabel.Parent = playerSettingsTab

local cameraModeToggle = Instance.new("TextButton")
cameraModeToggle.Name = "CameraModeToggle"
cameraModeToggle.Text = "Third Person"
cameraModeToggle.Font = Enum.Font.GothamBold
cameraModeToggle.TextSize = 16
cameraModeToggle.TextColor3 = Color3.fromRGB(255,255,255)
cameraModeToggle.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
cameraModeToggle.Size = UDim2.new(0, 120, 0, 24)
cameraModeToggle.Position = UDim2.new(0, 130, 0, 160)
cameraModeToggle.Parent = playerSettingsTab

local isFirstPerson = false
cameraModeToggle.MouseButton1Click:Connect(function()
	isFirstPerson = not isFirstPerson
	if isFirstPerson then
		cameraModeToggle.Text = "First Person"
		LocalPlayer.CameraMode = Enum.CameraMode.LockFirstPerson
	else
		cameraModeToggle.Text = "Third Person"
		LocalPlayer.CameraMode = Enum.CameraMode.Classic
	end
end)

-- NEW: God Mode (Legacy) Toggle
local godModeLabel = Instance.new("TextLabel")
godModeLabel.Text = "God mode (Legacy)"
godModeLabel.Font = Enum.Font.Gotham
godModeLabel.TextSize = 16
godModeLabel.TextColor3 = Color3.fromRGB(255,255,255)
godModeLabel.BackgroundTransparency = 1
godModeLabel.Size = UDim2.new(0, 140, 0, 24)
godModeLabel.Position = UDim2.new(0, 0, 0, 200)
godModeLabel.Parent = playerSettingsTab

local godModeToggle = Instance.new("TextButton")
godModeToggle.Name = "GodModeToggle"
godModeToggle.Text = "OFF"
godModeToggle.Font = Enum.Font.GothamBold
godModeToggle.TextSize = 16
godModeToggle.TextColor3 = Color3.fromRGB(255,255,255)
godModeToggle.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
godModeToggle.Size = UDim2.new(0, 60, 0, 24)
godModeToggle.Position = UDim2.new(0, 150, 0, 200)
godModeToggle.Parent = playerSettingsTab

local godModeActive = false
local godModeConn = nil

local function enableGodMode()
	if godModeConn then godModeConn:Disconnect() end
	local function attachToCharacter(character)
		if not godModeActive then return end
		local humanoid = character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			if godModeConn then godModeConn:Disconnect() end
			godModeConn = humanoid.Died:Connect(function()
				if not godModeActive then return end
				-- Save position, stats, and tools
				local rootPart = character:FindFirstChild("HumanoidRootPart")
				local lastCFrame = rootPart and rootPart.CFrame
				local lastWalkSpeed = humanoid.WalkSpeed
				local lastJumpPower = humanoid.JumpPower
				local tools = {}
				for _, tool in LocalPlayer.Backpack:GetChildren() do
					if tool:IsA("Tool") then
						table.insert(tools, tool.Name)
					end
				end
				for _, tool in character:GetChildren() do
					if tool:IsA("Tool") then
						table.insert(tools, tool.Name)
					end
				end
				-- Respawn instantly
				task.wait(0.1)
				LocalPlayer:LoadCharacter()
				local newChar = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
				local newHumanoid = newChar:FindFirstChildOfClass("Humanoid")
				if lastCFrame then
					local root = newChar:FindFirstChild("HumanoidRootPart")
					if root then
						root.CFrame = lastCFrame
					end
				end
				if newHumanoid then
					newHumanoid.WalkSpeed = lastWalkSpeed
					newHumanoid.JumpPower = lastJumpPower
				end
				-- Restore tools
				for _, toolName in tools do
					local tool = LocalPlayer.Backpack:FindFirstChild(toolName)
					if not tool then
						tool = newChar:FindFirstChild(toolName)
					end
					if tool then
						tool.Parent = newChar
					end
				end
				-- Re-attach god mode to new character
				attachToCharacter(newChar)
			end)
		end
	end
	if LocalPlayer.Character then
		attachToCharacter(LocalPlayer.Character)
	end
	LocalPlayer.CharacterAdded:Connect(function(character)
		attachToCharacter(character)
	end)
end

local function disableGodMode()
	if godModeConn then
		godModeConn:Disconnect()
		godModeConn = nil
	end
end

godModeToggle.MouseButton1Click:Connect(function()
	godModeActive = not godModeActive
	godModeToggle.Text = godModeActive and "ON" or "OFF"
	if godModeActive then
		enableGodMode()
	else
		disableGodMode()
	end
end)

-- NEW: Remove Admin UI Script Button in Player Settings
local removeScriptBtn = Instance.new("TextButton")
removeScriptBtn.Name = "RemoveAdminUIScriptBtn"
removeScriptBtn.Text = "Remove Admin UI Script"
removeScriptBtn.Font = Enum.Font.GothamBold
removeScriptBtn.TextSize = 16
removeScriptBtn.TextColor3 = Color3.fromRGB(255,255,255)
removeScriptBtn.BackgroundColor3 = Color3.fromRGB(180, 40, 40)
removeScriptBtn.Size = UDim2.new(0, 200, 0, 32)
removeScriptBtn.Position = UDim2.new(0, 0, 0, 240)
removeScriptBtn.Parent = playerSettingsTab

removeScriptBtn.MouseButton1Click:Connect(function()
	-- Remove the script from StarterPlayerScripts
	script:Destroy()
end)

-- NEW: Get All Badges Button in Player Settings (without RemoteEvent)
local getAllBadgesBtn = Instance.new("TextButton")
getAllBadgesBtn.Name = "GetAllBadgesBtn"
getAllBadgesBtn.Text = "Get All Badges"
getAllBadgesBtn.Font = Enum.Font.GothamBold
getAllBadgesBtn.TextSize = 16
getAllBadgesBtn.TextColor3 = Color3.fromRGB(255,255,255)
getAllBadgesBtn.BackgroundColor3 = Color3.fromRGB(80, 180, 80)
getAllBadgesBtn.Size = UDim2.new(0, 200, 0, 32)
getAllBadgesBtn.Position = UDim2.new(0, 0, 0, 280)
getAllBadgesBtn.Parent = playerSettingsTab

getAllBadgesBtn.MouseButton1Click:Connect(function()
	-- Try to award all badges (client-side, will not work in Roblox)
	local BadgeService = game:GetService("BadgeService")
	local badges = {}
	if game:FindFirstChild("Badges") then
		for _, badgeObj in game.Badges:GetChildren() do
			if badgeObj:IsA("Badge") then
				table.insert(badges, badgeObj.BadgeId)
			end
		end
	end
	local success = false
	for _, badgeId in badges do
		local ok, err = pcall(function()
			BadgeService:AwardBadge(LocalPlayer.UserId, badgeId)
		end)
		if ok then
			success = true
		end
	end
	-- Show message to player
	local msg = Instance.new("TextLabel")
	msg.Name = "BadgeMsg"
	msg.Text = success and "Badges awarded!" or "Cannot award badges from client.\nAsk the game owner to enable badge giving."
	msg.Font = Enum.Font.GothamBold
	msg.TextSize = 16
	msg.TextColor3 = Color3.fromRGB(255,255,255)
	msg.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
	msg.Size = UDim2.new(0, 260, 0, 48)
	msg.Position = UDim2.new(0, 0, 0, 320)
	msg.Parent = playerSettingsTab
	task.wait(2)
	msg:Destroy()
end)

-- Game Settings UI
local destroyAnimatronicsBtn = Instance.new("TextButton")
destroyAnimatronicsBtn.Name = "DestroyAnimatronicsBtn"
destroyAnimatronicsBtn.Text = "Destroy animatronics"
destroyAnimatronicsBtn.Font = Enum.Font.GothamBold
destroyAnimatronicsBtn.TextSize = 18
destroyAnimatronicsBtn.TextColor3 = Color3.fromRGB(255,255,255)
destroyAnimatronicsBtn.BackgroundColor3 = Color3.fromRGB(120, 40, 40)
destroyAnimatronicsBtn.Size = UDim2.new(0, 220, 0, 40)
destroyAnimatronicsBtn.Position = UDim2.new(0, 0, 0, 0)
destroyAnimatronicsBtn.Parent = gameSettingsTab

-- NEW BUTTON: Destroy all Jumpscares
local destroyJumpscaresBtn = Instance.new("TextButton")
destroyJumpscaresBtn.Name = "DestroyJumpscaresBtn"
destroyJumpscaresBtn.Text = "Destroy all Jumpscares"
destroyJumpscaresBtn.Font = Enum.Font.GothamBold
destroyJumpscaresBtn.TextSize = 18
destroyJumpscaresBtn.TextColor3 = Color3.fromRGB(255,255,255)
destroyJumpscaresBtn.BackgroundColor3 = Color3.fromRGB(120, 40, 80)
destroyJumpscaresBtn.Size = UDim2.new(0, 220, 0, 40)
destroyJumpscaresBtn.Position = UDim2.new(0, 0, 0, 48)
destroyJumpscaresBtn.Parent = gameSettingsTab

-- NEW: Day/Night Toggle
local dayNightLabel = Instance.new("TextLabel")
dayNightLabel.Text = "Day/Night"
dayNightLabel.Font = Enum.Font.Gotham
dayNightLabel.TextSize = 16
dayNightLabel.TextColor3 = Color3.fromRGB(255,255,255)
dayNightLabel.BackgroundTransparency = 1
dayNightLabel.Size = UDim2.new(0, 120, 0, 24)
dayNightLabel.Position = UDim2.new(0, 0, 0, 96)
dayNightLabel.Parent = gameSettingsTab

local dayNightToggle = Instance.new("TextButton")
dayNightToggle.Name = "DayNightToggle"
dayNightToggle.Text = "Day"
dayNightToggle.Font = Enum.Font.GothamBold
dayNightToggle.TextSize = 16
dayNightToggle.TextColor3 = Color3.fromRGB(255,255,255)
dayNightToggle.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
dayNightToggle.Size = UDim2.new(0, 120, 0, 24)
dayNightToggle.Position = UDim2.new(0, 130, 0, 96)
dayNightToggle.Parent = gameSettingsTab

-- NEW BUTTON: Delete all CodeDoor folders
local deleteCodeDoorBtn = Instance.new("TextButton")
deleteCodeDoorBtn.Name = "DeleteCodeDoorBtn"
deleteCodeDoorBtn.Text = "Delete all CodeDoor folders"
deleteCodeDoorBtn.Font = Enum.Font.GothamBold
deleteCodeDoorBtn.TextSize = 18
deleteCodeDoorBtn.TextColor3 = Color3.fromRGB(255,255,255)
deleteCodeDoorBtn.BackgroundColor3 = Color3.fromRGB(180, 40, 40)
deleteCodeDoorBtn.Size = UDim2.new(0, 260, 0, 40)
deleteCodeDoorBtn.Position = UDim2.new(0, 0, 0, 136)
deleteCodeDoorBtn.Parent = gameSettingsTab

-- NEW BUTTON: Show all Tools in Workspace
local showToolsBtn = Instance.new("TextButton")
showToolsBtn.Name = "ShowToolsBtn"
showToolsBtn.Text = "Show all Tools in Workspace"
showToolsBtn.Font = Enum.Font.GothamBold
showToolsBtn.TextSize = 18
showToolsBtn.TextColor3 = Color3.fromRGB(255,255,255)
showToolsBtn.BackgroundColor3 = Color3.fromRGB(80, 120, 180)
showToolsBtn.Size = UDim2.new(0, 260, 0, 40)
showToolsBtn.Position = UDim2.new(0, 0, 0, 184)
showToolsBtn.Parent = gameSettingsTab

local isNight = false
dayNightToggle.MouseButton1Click:Connect(function()
	isNight = not isNight
	if isNight then
		dayNightToggle.Text = "Night"
		Lighting.TimeOfDay = "00:00:00"
		Lighting.Brightness = 1
		Lighting.Ambient = Color3.fromRGB(30, 30, 60)
		Lighting.OutdoorAmbient = Color3.fromRGB(20, 20, 40)
	else
		dayNightToggle.Text = "Day"
		Lighting.TimeOfDay = "12:00:00"
		Lighting.Brightness = 2
		Lighting.Ambient = Color3.fromRGB(128, 128, 128)
		Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
	end
end)

-- UI Logic
local minSize = Vector2.new(300, 180)
local maxSize = Vector2.new(700, 500)

plusBtn.MouseButton1Click:Connect(function()
	local newSize = mainFrame.Size + UDim2.new(0, 50, 0, 35)
	if newSize.X.Offset > maxSize.X then newSize = UDim2.new(0, maxSize.X, 0, newSize.Y.Offset) end
	if newSize.Y.Offset > maxSize.Y then newSize = UDim2.new(0, newSize.X.Offset, 0, maxSize.Y) end
	TweenService:Create(mainFrame, TweenInfo.new(0.2), {Size = newSize}):Play()
end)

minusBtn.MouseButton1Click:Connect(function()
	local newSize = mainFrame.Size - UDim2.new(0, 50, 0, 35)
	if newSize.X.Offset < minSize.X then newSize = UDim2.new(0, minSize.X, 0, newSize.Y.Offset) end
	if newSize.Y.Offset < minSize.Y then newSize = UDim2.new(0, newSize.X.Offset, 0, minSize.Y) end
	TweenService:Create(mainFrame, TweenInfo.new(0.2), {Size = newSize}):Play()
end)

playerSettingsTabBtn.MouseButton1Click:Connect(function()
	playerSettingsTab.Visible = true
	gameSettingsTab.Visible = false
end)

gameSettingsTabBtn.MouseButton1Click:Connect(function()
	playerSettingsTab.Visible = false
	gameSettingsTab.Visible = true
end)

-- WalkSpeed Slider Logic
walkSpeedSlider.OnValueChanged = function(val)
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("Humanoid") then
		character.Humanoid.WalkSpeed = val
	end
end

-- JumpPower Slider Logic
jumpPowerSlider.OnValueChanged = function(val)
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("Humanoid") then
		character.Humanoid.JumpPower = val
	end
end

-- Noclip Logic
local noclipActive = false
noclipToggle.MouseButton1Click:Connect(function()
	noclipActive = not noclipActive
	noclipToggle.Text = noclipActive and "ON" or "OFF"
	local character = LocalPlayer.Character
	if character then
		for _, part in character:GetChildren() do
			if part:IsA("BasePart") then
				part.CanCollide = not noclipActive
			end
		end
	end
end)

-- Fly Logic
local flyActive = false
local flyBodyVelocity = nil
flyToggle.MouseButton1Click:Connect(function()
	flyActive = not flyActive
	flyToggle.Text = flyActive and "ON" or "OFF"
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("HumanoidRootPart") then
		if flyActive then
			flyBodyVelocity = Instance.new("BodyVelocity")
			flyBodyVelocity.MaxForce = Vector3.new(1e5, 1e5, 1e5)
			flyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
			flyBodyVelocity.Parent = character.HumanoidRootPart
		else
			if flyBodyVelocity then
				flyBodyVelocity:Destroy()
				flyBodyVelocity = nil
			end
		end
	end
end)

UserInputService.InputBegan:Connect(function(input, processed)
	if flyActive and flyBodyVelocity and not processed then
		if input.KeyCode == Enum.KeyCode.W then
			flyBodyVelocity.Velocity = Workspace.CurrentCamera.CFrame.LookVector * 50
		elseif input.KeyCode == Enum.KeyCode.S then
			flyBodyVelocity.Velocity = -Workspace.CurrentCamera.CFrame.LookVector * 50
		elseif input.KeyCode == Enum.KeyCode.Space then
			flyBodyVelocity.Velocity = Vector3.new(0, 50, 0)
		elseif input.KeyCode == Enum.KeyCode.LeftControl then
			flyBodyVelocity.Velocity = Vector3.new(0, -50, 0)
		end
	end
end)

UserInputService.InputEnded:Connect(function(input, processed)
	if flyActive and flyBodyVelocity and not processed then
		flyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
	end
end)

-- Destroy Animatronics Logic
destroyAnimatronicsBtn.MouseButton1Click:Connect(function()
	local folders = {"AiWithSkins", "RunningAnimatronic", "Npc"}
	for _, folderName in folders do
		local folder = Workspace:FindFirstChild(folderName)
		if folder then
			folder:Destroy()
		end
	end
end)

-- Destroy all Jumpscares Logic (removes from StarterGui, CoreGui, PlayerGui, StarterPlayerScripts, StarterCharacterScripts)
destroyJumpscaresBtn.MouseButton1Click:Connect(function()
	local jumpscareNames = {
		"PaulieJumpScareUI",
		"UnknownSewerJumpScareUI",
		"NoodlesJumpScareUI",
		"MeatballJumpScareUI",
		"MascotJumpScareUI",
		"EndoJumpScareUI",
		"DoughyJumpScareUI",
		"DonnyJumpScareUI",
		"BuddyJumpScareUI",
		"BettyJumpScareUI",
		"BennyJumpScareUI"
	}

	local locations = {
		game:GetService("CoreGui"),
		game:GetService("StarterGui"),
		LocalPlayer:FindFirstChild("PlayerGui"),
		game:GetService("StarterPlayer"):FindFirstChild("StarterPlayerScripts"),
		game:GetService("StarterPlayer"):FindFirstChild("StarterCharacterScripts")
	}

	for _, location in locations do
		if location then
			for _, uiName in jumpscareNames do
				local ui = location:FindFirstChild(uiName)
				if ui then
					ui:Destroy()
				end
			end
		end
	end
end)

-- Delete all CodeDoor folders Logic
deleteCodeDoorBtn.MouseButton1Click:Connect(function()
	local toDelete = {}
	for _, descendant in Workspace:GetDescendants() do
		if descendant:IsA("Folder") and descendant.Name == "CodeDoor" then
			table.insert(toDelete, descendant)
		end
	end
	for _, folder in toDelete do
		folder:Destroy()
	end
end)

-- Show all Tools in Workspace Logic
showToolsBtn.MouseButton1Click:Connect(function()
	-- Create the scrolling frame
	local toolsFrame = Instance.new("Frame")
	toolsFrame.Name = "ToolsFrame"
	toolsFrame.Size = UDim2.new(0, 300, 0, 220)
	toolsFrame.Position = UDim2.new(0.5, -150, 0.5, -110)
	toolsFrame.AnchorPoint = Vector2.new(0.5, 0.5)
	toolsFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
	toolsFrame.BorderSizePixel = 0
	toolsFrame.Parent = screenGui
	toolsFrame.Active = true

	local toolsCorner = Instance.new("UICorner")
	toolsCorner.CornerRadius = UDim.new(0, 10)
	toolsCorner.Parent = toolsFrame

	local closeBtn = Instance.new("TextButton")
	closeBtn.Name = "CloseBtn"
	closeBtn.Text = "X"
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.TextSize = 18
	closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
	closeBtn.BackgroundColor3 = Color3.fromRGB(180, 40, 40)
	closeBtn.Size = UDim2.new(0, 32, 0, 32)
	closeBtn.Position = UDim2.new(1, -36, 0, 4)
	closeBtn.Parent = toolsFrame

	closeBtn.MouseButton1Click:Connect(function()
		toolsFrame:Destroy()
	end)

	local scroll = Instance.new("ScrollingFrame")
	scroll.Name = "ToolsScrollingFrame"
	scroll.Size = UDim2.new(1, -16, 1, -48)
	scroll.Position = UDim2.new(0, 8, 0, 40)
	scroll.BackgroundTransparency = 1
	scroll.BorderSizePixel = 0
	scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
	scroll.ScrollBarThickness = 8
	scroll.Parent = toolsFrame

	local layout = Instance.new("UIListLayout")
	layout.Parent = scroll
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Padding = UDim.new(0, 4)

	-- Find all tools in workspace
	local toolList = {}
	for _, descendant in Workspace:GetDescendants() do
		if descendant:IsA("Tool") then
			table.insert(toolList, descendant)
		end
	end

	for _, tool in toolList do
		local btn = Instance.new("TextButton")
		btn.Name = "ToolBtn_" .. tool.Name
		btn.Text = tool.Name
		btn.Font = Enum.Font.GothamBold
		btn.TextSize = 16
		btn.TextColor3 = Color3.fromRGB(255,255,255)
		btn.BackgroundColor3 = Color3.fromRGB(80, 120, 180)
		btn.Size = UDim2.new(1, 0, 0, 32)
		btn.Parent = scroll

		btn.MouseButton1Click:Connect(function()
			-- Teleport player to tool's position
			local char = LocalPlayer.Character
			if char and char:FindFirstChild("HumanoidRootPart") then
				local toolPivot = tool:GetPivot()
				char:PivotTo(toolPivot)
			end
		end)
	end

	-- Adjust canvas size
	task.wait()
	scroll.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y)
end)

-- UI Parent
screenGui.Parent = game:GetService("CoreGui")

-- PLAY INTRO AND SHOW ADMIN PANEL AFTER
playIntro()
mainFrame.Visible = true

